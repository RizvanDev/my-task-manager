{"ast":null,"code":"import _objectSpread from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _createForOfIteratorHelper from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _defineProperty from\"C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import{initializeApp}from'firebase/app';import{getAuth,signInWithEmailAndPassword,createUserWithEmailAndPassword,onAuthStateChanged,signOut}from'firebase/auth';import{getDatabase,onValue,ref,set}from'firebase/database';var firebaseConfig=_defineProperty({apiKey:process.env.REACT_APP_FIREBASE_API_KEY,authDomain:process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,databaseURL:process.env.REACT_APP_FIREBASE_DATABASE_URL,projectId:process.env.REACT_APP_FIREBASE_PROJECT_ID,storageBucket:process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,messagingSenderId:process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,appId:process.env.REACT_APP_FIREBASE_APP_ID},\"databaseURL\",process.env.REACT_APP_FIREBASE_DATABASE_URL);var app=initializeApp(firebaseConfig);var auth=getAuth(app);var db=getDatabase(app);var addEmptyArrays=function addEmptyArrays(data){if(data){var _iterator=_createForOfIteratorHelper(data),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var obj=_step.value;if(!obj.hasOwnProperty('data'))obj.data=[];}}catch(err){_iterator.e(err);}finally{_iterator.f();}return data;}return[];};var database={writeUserData:function writeUserData(userId,userInfo,tabItems){var reference=ref(db,'users/'+userId);if(userId){set(reference,{username:userInfo.nick,email:userInfo.email,profile_picture:userInfo.photo,data:tabItems});}},readUserData:function readUserData(userId,setUserInfo,setTabItem,setTab){var distanceRef=ref(db,'users/'+userId);onValue(distanceRef,function(snapshot){var userData=snapshot.val();setUserInfo({photo:userData.profile_picture,nick:userData.username,email:userData.email});setTabItem(_toConsumableArray(addEmptyArrays(userData.data)));setTab(userData.data?userData.data[0].title:'');});}};// Authentication methods\nvar authentication={// Login\nloginEmailPassword:function(){var _loginEmailPassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var params,userCredential;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:params=Object.assign({},_ref);if(!params.login.Password){_context.next=16;break;}_context.prev=2;_context.next=5;return signInWithEmailAndPassword(auth,params.login.Email,params.login.Password);case 5:userCredential=_context.sent;database.readUserData(userCredential.user.uid,params.setUserInfo,params.setTabItem,params.setTab);params.setLogin({Email:'',Password:''});setTimeout(function(){params.setAuthModal(false);},1000);params.createAuthInfoModal({modal:true,type:'Success',text:'Authorization successfully'});_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](2);console.log(_context.t0);params.createAuthInfoModal({modal:true,type:'Error',text:_context.t0.code});case 16:case\"end\":return _context.stop();}}},_callee,null,[[2,12]]);}));function loginEmailPassword(_x){return _loginEmailPassword.apply(this,arguments);}return loginEmailPassword;}(),// Registration\nregistrationEmailPassword:function(){var _registrationEmailPassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(_ref2){var params,userCredential;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:params=Object.assign({},_ref2);if(!params.registration.Password){_context2.next=16;break;}_context2.prev=2;_context2.next=5;return createUserWithEmailAndPassword(auth,params.registration.Email,params.registration.Password);case 5:userCredential=_context2.sent;database.writeUserData(userCredential.user.uid,params.userInfo,params.tabItems);params.setRegistration({Email:'',Password:''});setTimeout(function(){params.setAuthModal(false);params.navigate('Profile.jsx');},1000);params.createAuthInfoModal({modal:true,type:'Success',text:'Registration successfully'});_context2.next=16;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](2);console.log(_context2.t0);params.createAuthInfoModal({modal:true,type:'Error',text:_context2.t0.code});case 16:case\"end\":return _context2.stop();}}},_callee2,null,[[2,12]]);}));function registrationEmailPassword(_x2){return _registrationEmailPassword.apply(this,arguments);}return registrationEmailPassword;}(),// State\nmonitorAuthState:function monitorAuthState(setAuthorization,defaultPhoto,userInfo,setUserInfo,setUserId,setTabItem,setTab,defaultItems){return onAuthStateChanged(auth,function(user){if(user){setAuthorization(true);setUserId(user.uid);setUserInfo(_objectSpread(_objectSpread({},userInfo),{},{email:user.email}));}else{setAuthorization(false);setUserId('');setUserInfo({photo:defaultPhoto,nick:'username',email:''});setTabItem(_toConsumableArray(defaultItems));setTab(defaultItems[0].title);}});},// Logout\nlogOut:function(){var _logOut=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return signOut(auth);case 2:return _context3.abrupt(\"return\",_context3.sent);case 3:case\"end\":return _context3.stop();}}},_callee3);}));function logOut(){return _logOut.apply(this,arguments);}return logOut;}()};export{authentication,database};","map":{"version":3,"names":["initializeApp","getAuth","signInWithEmailAndPassword","createUserWithEmailAndPassword","onAuthStateChanged","signOut","getDatabase","onValue","ref","set","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","app","auth","db","addEmptyArrays","data","obj","hasOwnProperty","database","writeUserData","userId","userInfo","tabItems","reference","username","nick","email","profile_picture","photo","readUserData","setUserInfo","setTabItem","setTab","distanceRef","snapshot","userData","val","title","authentication","loginEmailPassword","params","login","Password","Email","userCredential","user","uid","setLogin","setTimeout","setAuthModal","createAuthInfoModal","modal","type","text","console","log","code","registrationEmailPassword","registration","setRegistration","navigate","monitorAuthState","setAuthorization","defaultPhoto","setUserId","defaultItems","logOut"],"sources":["C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/src/firebase/firebaseConfig.js"],"sourcesContent":["import { initializeApp } from 'firebase/app'\r\nimport {\r\n  getAuth,\r\n  signInWithEmailAndPassword,\r\n  createUserWithEmailAndPassword,\r\n  onAuthStateChanged,\r\n  signOut,\r\n} from 'firebase/auth'\r\nimport { getDatabase, onValue, ref, set } from 'firebase/database'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n}\r\n\r\nconst app = initializeApp(firebaseConfig)\r\nconst auth = getAuth(app)\r\nconst db = getDatabase(app)\r\n\r\nconst addEmptyArrays = data => {\r\n  if (data) {\r\n    for (const obj of data) {\r\n      if (!obj.hasOwnProperty('data')) obj.data = []\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  return []\r\n}\r\n\r\nconst database = {\r\n  writeUserData: (userId, userInfo, tabItems) => {\r\n    const reference = ref(db, 'users/' + userId)\r\n    if (userId) {\r\n      set(reference, {\r\n        username: userInfo.nick,\r\n        email: userInfo.email,\r\n        profile_picture: userInfo.photo,\r\n        data: tabItems,\r\n      })\r\n    }\r\n  },\r\n  readUserData: (userId, setUserInfo, setTabItem, setTab) => {\r\n    const distanceRef = ref(db, 'users/' + userId)\r\n\r\n    onValue(distanceRef, snapshot => {\r\n      const userData = snapshot.val()\r\n      setUserInfo({\r\n        photo: userData.profile_picture,\r\n        nick: userData.username,\r\n        email: userData.email,\r\n      })\r\n\r\n      setTabItem([...addEmptyArrays(userData.data)])\r\n      setTab(userData.data ? userData.data[0].title : '')\r\n    })\r\n  },\r\n}\r\n\r\n// Authentication methods\r\nconst authentication = {\r\n  // Login\r\n  loginEmailPassword: async ({ ...params }) => {\r\n    if (params.login.Password) {\r\n      try {\r\n        const userCredential = await signInWithEmailAndPassword(\r\n          auth,\r\n          params.login.Email,\r\n          params.login.Password,\r\n        )\r\n\r\n        database.readUserData(\r\n          userCredential.user.uid,\r\n          params.setUserInfo,\r\n          params.setTabItem,\r\n          params.setTab,\r\n        )\r\n\r\n        params.setLogin({ Email: '', Password: '' })\r\n\r\n        setTimeout(() => {\r\n          params.setAuthModal(false)\r\n        }, 1000)\r\n\r\n        params.createAuthInfoModal({\r\n          modal: true,\r\n          type: 'Success',\r\n          text: 'Authorization successfully',\r\n        })\r\n      } catch (Error) {\r\n        console.log(Error)\r\n        params.createAuthInfoModal({ modal: true, type: 'Error', text: Error.code })\r\n      }\r\n    }\r\n  },\r\n  // Registration\r\n  registrationEmailPassword: async ({ ...params }) => {\r\n    if (params.registration.Password) {\r\n      try {\r\n        const userCredential = await createUserWithEmailAndPassword(\r\n          auth,\r\n          params.registration.Email,\r\n          params.registration.Password,\r\n        )\r\n\r\n        database.writeUserData(userCredential.user.uid, params.userInfo, params.tabItems)\r\n\r\n        params.setRegistration({ Email: '', Password: '' })\r\n\r\n        setTimeout(() => {\r\n          params.setAuthModal(false)\r\n          params.navigate('Profile.jsx')\r\n        }, 1000)\r\n\r\n        params.createAuthInfoModal({\r\n          modal: true,\r\n          type: 'Success',\r\n          text: 'Registration successfully',\r\n        })\r\n      } catch (Error) {\r\n        console.log(Error)\r\n        params.createAuthInfoModal({ modal: true, type: 'Error', text: Error.code })\r\n      }\r\n    }\r\n  },\r\n  // State\r\n  monitorAuthState: (\r\n    setAuthorization,\r\n    defaultPhoto,\r\n    userInfo,\r\n    setUserInfo,\r\n    setUserId,\r\n    setTabItem,\r\n    setTab,\r\n    defaultItems,\r\n  ) => {\r\n    return onAuthStateChanged(auth, user => {\r\n      if (user) {\r\n        setAuthorization(true)\r\n        setUserId(user.uid)\r\n        setUserInfo({ ...userInfo, email: user.email })\r\n      } else {\r\n        setAuthorization(false)\r\n        setUserId('')\r\n        setUserInfo({ photo: defaultPhoto, nick: 'username', email: '' })\r\n        setTabItem([...defaultItems])\r\n        setTab(defaultItems[0].title)\r\n      }\r\n    })\r\n  },\r\n  // Logout\r\n  logOut: async () => await signOut(auth),\r\n}\r\n\r\nexport { authentication, database }\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}