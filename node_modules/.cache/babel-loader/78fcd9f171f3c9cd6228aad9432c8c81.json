{"ast":null,"code":"import { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from 'firebase/auth';\nimport { getDatabase, onValue, ref, set } from 'firebase/database';\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL\n};\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst db = getDatabase(app);\n\nconst addEmptyArrays = data => {\n  if (data) {\n    for (const obj of data) {\n      if (!obj.hasOwnProperty('data')) obj.data = [];\n    }\n\n    return data;\n  }\n\n  return [];\n}; // database\n\n\nconst database = {\n  writeUserData: (userId, userInfo, tabItems) => {\n    const reference = ref(db, 'users/' + userId);\n\n    if (userId) {\n      set(reference, {\n        username: userInfo.nick,\n        email: userInfo.email,\n        profile_picture: userInfo.photo,\n        data: [{\n          date: new Date().toLocaleDateString(),\n          tasks: tabItems\n        }]\n      });\n    }\n  },\n  readUserData: (userId, setUserInfo, setTabItem, setTab, setCategory) => {\n    const distanceRef = ref(db, 'users/' + userId);\n    onValue(distanceRef, snapshot => {\n      const userData = snapshot.val();\n      setUserInfo({\n        photo: userData.profile_picture,\n        nick: userData.username,\n        email: userData.email\n      });\n      console.log(userData.data[0].tasks);\n      setTabItem([...addEmptyArrays(userData.data[0].tasks)]);\n      setCategory(userData.data.tasks ? userData.data[0].tasks[0].title : '');\n      setTab(userData.data.tasks ? userData.data[0].tasks[0].title : '');\n    });\n  }\n}; // Authentication methods\n\nconst authentication = {\n  // Login\n  loginEmailPassword: async _ref => {\n    let { ...params\n    } = _ref;\n\n    if (params.login.Password) {\n      try {\n        const userCredential = await signInWithEmailAndPassword(auth, params.login.Email, params.login.Password);\n        database.readUserData(userCredential.user.uid, params.setUserInfo, params.setTabItem, params.setTab, params.setCategory);\n        params.setLogin({\n          Email: '',\n          Password: ''\n        });\n        setTimeout(() => {\n          params.setAuthModal(false);\n        }, 1000);\n        params.createAuthInfoModal({\n          modal: true,\n          type: 'Success',\n          text: 'Authorization successfully'\n        });\n      } catch (Error) {\n        console.log(Error);\n        params.createAuthInfoModal({\n          modal: true,\n          type: 'Error',\n          text: Error.code\n        });\n      }\n    }\n  },\n  // Registration\n  registrationEmailPassword: async _ref2 => {\n    let { ...params\n    } = _ref2;\n\n    if (params.registration.Password) {\n      try {\n        const userCredential = await createUserWithEmailAndPassword(auth, params.registration.Email, params.registration.Password);\n        database.writeUserData(userCredential.user.uid, params.userInfo, params.tabItems);\n        params.setRegistration({\n          Email: '',\n          Password: ''\n        });\n        setTimeout(() => {\n          params.setAuthModal(false);\n          params.navigate('Profile.jsx');\n        }, 1000);\n        params.createAuthInfoModal({\n          modal: true,\n          type: 'Success',\n          text: 'Registration successfully'\n        });\n      } catch (Error) {\n        console.log(Error);\n        params.createAuthInfoModal({\n          modal: true,\n          type: 'Error',\n          text: Error.code\n        });\n      }\n    }\n  },\n  // State\n  monitorAuthState: (setAuthorization, defaultPhoto, userInfo, setUserInfo, setUserId) => {\n    return onAuthStateChanged(auth, user => {\n      if (user) {\n        setAuthorization(true);\n        setUserId(user.uid);\n        setUserInfo({ ...userInfo,\n          email: user.email\n        });\n      } else {\n        setAuthorization(false);\n        setUserId('');\n        setUserInfo({\n          photo: defaultPhoto,\n          nick: 'username',\n          email: ''\n        });\n      }\n    });\n  },\n  // Logout\n  logOut: (defaultItems, setTabItem, setTab, setCategory) => {\n    return signOut(auth).then(() => {\n      setTabItem([...defaultItems]);\n      setTab(defaultItems[0].title);\n      setCategory(defaultItems[0].title);\n    });\n  }\n};\nexport { authentication, database };","map":{"version":3,"names":["initializeApp","getAuth","signInWithEmailAndPassword","createUserWithEmailAndPassword","onAuthStateChanged","signOut","getDatabase","onValue","ref","set","firebaseConfig","apiKey","process","env","REACT_APP_FIREBASE_API_KEY","authDomain","REACT_APP_FIREBASE_AUTH_DOMAIN","databaseURL","REACT_APP_FIREBASE_DATABASE_URL","projectId","REACT_APP_FIREBASE_PROJECT_ID","storageBucket","REACT_APP_FIREBASE_STORAGE_BUCKET","messagingSenderId","REACT_APP_FIREBASE_MESSAGING_SENDER_ID","appId","REACT_APP_FIREBASE_APP_ID","app","auth","db","addEmptyArrays","data","obj","hasOwnProperty","database","writeUserData","userId","userInfo","tabItems","reference","username","nick","email","profile_picture","photo","date","Date","toLocaleDateString","tasks","readUserData","setUserInfo","setTabItem","setTab","setCategory","distanceRef","snapshot","userData","val","console","log","title","authentication","loginEmailPassword","params","login","Password","userCredential","Email","user","uid","setLogin","setTimeout","setAuthModal","createAuthInfoModal","modal","type","text","Error","code","registrationEmailPassword","registration","setRegistration","navigate","monitorAuthState","setAuthorization","defaultPhoto","setUserId","logOut","defaultItems","then"],"sources":["C:/Users/DarkFlyingCat/Desktop/dev/my-task-manager/src/firebase/firebaseConfig.js"],"sourcesContent":["import { initializeApp } from 'firebase/app'\r\nimport {\r\n  getAuth,\r\n  signInWithEmailAndPassword,\r\n  createUserWithEmailAndPassword,\r\n  onAuthStateChanged,\r\n  signOut,\r\n} from 'firebase/auth'\r\nimport { getDatabase, onValue, ref, set } from 'firebase/database'\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\r\n  authDomain: process.env.REACT_APP_FIREBASE_AUTH_DOMAIN,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n  projectId: process.env.REACT_APP_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.REACT_APP_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.REACT_APP_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.REACT_APP_FIREBASE_APP_ID,\r\n  databaseURL: process.env.REACT_APP_FIREBASE_DATABASE_URL,\r\n}\r\n\r\nconst app = initializeApp(firebaseConfig)\r\nconst auth = getAuth(app)\r\nconst db = getDatabase(app)\r\n\r\nconst addEmptyArrays = data => {\r\n  if (data) {\r\n    for (const obj of data) {\r\n      if (!obj.hasOwnProperty('data')) obj.data = []\r\n    }\r\n\r\n    return data\r\n  }\r\n\r\n  return []\r\n}\r\n\r\n// database\r\nconst database = {\r\n  writeUserData: (userId, userInfo, tabItems) => {\r\n    const reference = ref(db, 'users/' + userId)\r\n    if (userId) {\r\n      set(reference, {\r\n        username: userInfo.nick,\r\n        email: userInfo.email,\r\n        profile_picture: userInfo.photo,\r\n        data: [{ date: new Date().toLocaleDateString(), tasks: tabItems }],\r\n      })\r\n    }\r\n  },\r\n  readUserData: (userId, setUserInfo, setTabItem, setTab, setCategory) => {\r\n    const distanceRef = ref(db, 'users/' + userId)\r\n\r\n    onValue(distanceRef, snapshot => {\r\n      const userData = snapshot.val()\r\n      setUserInfo({\r\n        photo: userData.profile_picture,\r\n        nick: userData.username,\r\n        email: userData.email,\r\n      })\r\n\r\n      console.log(userData.data[0].tasks)\r\n      setTabItem([...addEmptyArrays(userData.data[0].tasks)])\r\n      setCategory(userData.data.tasks ? userData.data[0].tasks[0].title : '')\r\n      setTab(userData.data.tasks ? userData.data[0].tasks[0].title : '')\r\n    })\r\n  },\r\n}\r\n// Authentication methods\r\nconst authentication = {\r\n  // Login\r\n  loginEmailPassword: async ({ ...params }) => {\r\n    if (params.login.Password) {\r\n      try {\r\n        const userCredential = await signInWithEmailAndPassword(\r\n          auth,\r\n          params.login.Email,\r\n          params.login.Password,\r\n        )\r\n\r\n        database.readUserData(\r\n          userCredential.user.uid,\r\n          params.setUserInfo,\r\n          params.setTabItem,\r\n          params.setTab,\r\n          params.setCategory,\r\n        )\r\n\r\n        params.setLogin({ Email: '', Password: '' })\r\n\r\n        setTimeout(() => {\r\n          params.setAuthModal(false)\r\n        }, 1000)\r\n\r\n        params.createAuthInfoModal({\r\n          modal: true,\r\n          type: 'Success',\r\n          text: 'Authorization successfully',\r\n        })\r\n      } catch (Error) {\r\n        console.log(Error)\r\n        params.createAuthInfoModal({ modal: true, type: 'Error', text: Error.code })\r\n      }\r\n    }\r\n  },\r\n  // Registration\r\n  registrationEmailPassword: async ({ ...params }) => {\r\n    if (params.registration.Password) {\r\n      try {\r\n        const userCredential = await createUserWithEmailAndPassword(\r\n          auth,\r\n          params.registration.Email,\r\n          params.registration.Password,\r\n        )\r\n\r\n        database.writeUserData(userCredential.user.uid, params.userInfo, params.tabItems)\r\n\r\n        params.setRegistration({ Email: '', Password: '' })\r\n\r\n        setTimeout(() => {\r\n          params.setAuthModal(false)\r\n          params.navigate('Profile.jsx')\r\n        }, 1000)\r\n\r\n        params.createAuthInfoModal({\r\n          modal: true,\r\n          type: 'Success',\r\n          text: 'Registration successfully',\r\n        })\r\n      } catch (Error) {\r\n        console.log(Error)\r\n        params.createAuthInfoModal({ modal: true, type: 'Error', text: Error.code })\r\n      }\r\n    }\r\n  },\r\n  // State\r\n  monitorAuthState: (\r\n    setAuthorization,\r\n    defaultPhoto,\r\n    userInfo,\r\n    setUserInfo,\r\n    setUserId,\r\n  ) => {\r\n    return onAuthStateChanged(auth, user => {\r\n      if (user) {\r\n        setAuthorization(true)\r\n        setUserId(user.uid)\r\n        setUserInfo({ ...userInfo, email: user.email })\r\n      } else {\r\n        setAuthorization(false)\r\n        setUserId('')\r\n        setUserInfo({ photo: defaultPhoto, nick: 'username', email: '' })\r\n      }\r\n    })\r\n  },\r\n  // Logout\r\n  logOut: (defaultItems, setTabItem, setTab, setCategory) => {\r\n    return signOut(auth).then(() => {\r\n      setTabItem([...defaultItems])\r\n      setTab(defaultItems[0].title)\r\n      setCategory(defaultItems[0].title)\r\n    })\r\n  },\r\n}\r\n\r\nexport { authentication, database }\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}